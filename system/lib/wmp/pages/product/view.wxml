<wxs src="../common/helper.wxs" module="helper" />
<view wx:if="{{!loading}}">
    <!-- 导入公共 header -->
    <include src="../common/header.wxml" />

    <!-- 导入布局模板 -->
    <import src="../block/layout.tpl.wxml" />

    <!-- 产品详情顶部布局 -->
    <view class="layout layout-top">
        <template wx:if="{{layouts.product_view && layouts.product_view.top}}" is="layout" data="{{blocks:layouts.product_view.top, config: config}}" />
    </view>

    <swiper wx:if="{{data.product.image.list}}" class="product-image-list gray" indicator-dots="true" autoplay="true" indicator-color="rgba(255,255,255,.5)" indicator-active-color="#fff">
        <block wx:for="{{data.product.image.list}}" wx:for-item="image" w:key="productImage">
            <swiper-item item-id="{{index}}">
                <image mode="aspectFit" src="{{helper.printFileURL(image, config)}}" class="product-image" />
            </swiper-item>
        </block>
    </swiper>

    <view class="header has-padding divider">
        <view class="h3 space-sm">{{data.product.name}}</view>
        <view wx:if="{{!data.product.unsaleable || data.product.unsaleable === '0'}}" class="flex-none title ele">
            <text wx:if="{{data.product.negotiate === '1'}}" class="text-brown">面议</text>
            <block wx:elif="{{data.product.promotion && data.product.promotion !== '0' && data.product.promotion !== '0.00'}}">
                <block wx:if="{{data.product.price && data.product.price !== '0' && data.product.price !== '0.00'}}">
                    <text class="text-danger strong">￥{{data.product.promotion}}</text>
                    <text class="text-line-through muted small">￥{{data.product.price}}</text>
                </block>
            </block>
            <text wx:elif="{{data.product.price && data.product.price !== '0' && data.product.price !== '0.00'}}">￥{{data.product.price}}</text>
        </view>
    </view>

    <view class="attributes divider small has-padding-v">
        <view wx:if="{{data.product.amount}}">
            <text class="attribute-label muted strong">库存</text>
            <text class="attribute-value">{{data.product.amount}}{{data.product.unit}}</text>
        </view>

        <view wx:if="{{data.product.brand}}">
            <text class="attribute-label muted strong">品牌</text>
            <text class="attribute-value">{{data.product.brand}} {{data.product.model}}</text>
        </view>

        <view wx:if="{{!data.product.brand && data.product.model}}">
            <text class="attribute-label muted strong">型号</text>
            <text class="attribute-value">{{data.product.model}}</text>
        </view>

        <view wx:if="{{data.product.color}}">
            <text class="attribute-label muted strong">颜色</text>
            <text class="attribute-value">{{data.product.color}}</text>
        </view>

        <view wx:if="{{data.product.origin}}">
            <text class="attribute-label muted strong">产地</text>
            <text class="attribute-value">{{data.product.origin}}</text>
        </view>

        <block wx:for="{{data.product.attributes}}" wx:for-item="attribute">
            <view wx:if="{{attribute.label && attribute.label && attribute.value && attribute.value}}">
                <text class="attribute-label muted strong">{{attribute.label}}</text>
                <text class="attribute-value">{{attribute.value}}</text>
            </view>
        </block>
    </view>

    <view class="content has-padding white fluid">
        <rich-text nodes="{{data.product.content}}" />
    </view>

    <!-- 产品详情底部布局 -->
    <view class="layout layout-bottom">
        <template wx:if="{{layouts.product_view && layouts.product_view.bottom}}" is="layout" data="{{blocks:layouts.product_view.bottom, config: config}}" />
    </view>

    <!-- 导入公共 header -->
    <include src="../common/footer.wxml" />
</view>